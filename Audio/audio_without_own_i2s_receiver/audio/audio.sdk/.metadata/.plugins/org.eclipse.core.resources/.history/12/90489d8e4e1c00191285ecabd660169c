#include <stdint.h>

#include "menu.h"
#include "menu_navigation.h"
#include "stdio.h"
#include "audio_driver.h"


int main() {
	audio_initialize();
    menu main_menu;

    menu_create_main_menu(&main_menu,"ADAU1761 Configuration");

    // create main menue submenues
    char *main_menu_submenus_titles[4] = {"Input Signal Config", "Output Signal Config", "standard configuration", "debug"};
    menu_create_submenus(&main_menu, 4, main_menu_submenus_titles);
    menu_set_function(main_menu.submenus[2], &audio_std_configuration);

    // create debug menus
    char *debug_options[3] = {"serial port mode","ADC control","serial port route"};
    menu_create_submenus(main_menu.submenus[3], 3, debug_options);
    menu* serial_port_mode = main_menu.submenus[3]->submenus[0];
    menu* adc_control = main_menu.submenus[3]->submenus[1];
    menu* serial_port_route = main_menu.submenus[3]->submenus[2];

    char* serial_port_mode_options[2] = {"slave","master"};
    uint8_t serial_port_mode_values[2] = {0x0,0x1};
    menu_create_submenus(serial_port_mode, 2, serial_port_mode_options);
    menu_set_submenu_reg_config_values(serial_port_mode, serial_port_mode_values, 2);
    menu_set_submenu_reg_config_addresses(serial_port_mode, R15_SERIAL_PORT_CTRL_0, 2);

    char* adc_control_options[3] = {"adc off","adc both on","adc both on inverted"};
    uint8_t adc_control_options_values[3] = {0x0,0x23,0x63};
    menu_create_submenus(adc_control, 3, adc_control_options);
    menu_set_submenu_reg_config_values(adc_control, adc_control_options_values, 3);
    menu_set_submenu_reg_config_addresses(adc_control, R19_ADC_CTRL, 3);

    char* serial_port_route_options[4] = {"L0_R0_to_L_R","L1_R1_to_L_R","L2_R2_to_L_R","L3_R3_to_L_R"};
    uint8_t serial_port_route_options_values[4] = {0x1,0x3,0x5,0x7};
    menu_create_submenus(serial_port_route, 4, serial_port_route_options);
    menu_set_submenu_reg_config_values(serial_port_route, serial_port_route_options_values, 4);
    menu_set_submenu_reg_config_addresses(serial_port_route, R59_SERIAL_OUT_ROUTE_CTRL, 4);


    // create input signal submenus
    char *input_signal_options[2] = {"Mixer 1 Left Record Mixer (MX1AUXG config)", "Mixer 2 Right Record Mixer (MX2AUXG config)"};
    menu_create_submenus(main_menu.submenus[0], 2, input_signal_options);

    // create output signal submenus
    char *output_signal_options[6] = {"Mixer 3 Left Playback Mixer (MX3AUXG config)", "Mixer 4 Right Playback Mixer (MX4AUXG config)",
                                      "Mixer 5 (Left L/R Playback Mixer)", "Mixer 6 (Right L/R Playback Mixer)",
									  "Mixer 3 Left Playback Mixer (MX3G1 config)","Mixer 4 Left Playback Mixer (MX4G2 config)"};
    menu_create_submenus(main_menu.submenus[1], 6, output_signal_options);

    // submenues
    menu * Mixer1 = main_menu.submenus[0]->submenus[0];
    menu * Mixer2 = main_menu.submenus[0]->submenus[1];
    menu * Mixer3 = main_menu.submenus[1]->submenus[0];
    menu * Mixer4 = main_menu.submenus[1]->submenus[1];
    menu * Mixer5 = main_menu.submenus[1]->submenus[2];
    menu * Mixer6 = main_menu.submenus[1]->submenus[3];

    menu * Mixer3_1 = main_menu.submenus[1]->submenus[4];
    menu * Mixer4_1 = main_menu.submenus[1]->submenus[5];
    char* mixer3_1_4_1_options = {"mute","0dB ","3dB ","6dB"};
    uint8_t mixer3_1_config_choices[4] = {0x0,0x6,0x7,0x8};
    uint8_t mixer4_1_config_choices[4] = {0x0,0x60,0x70,0x80};
    menu_create_submenus(Mixer3_1,4,mixer5_6_options);
    menu_create_submenus(Mixer4_1,4,mixer5_6_options);
    menu_set_submenu_reg_config_values(Mixer3_1, mixer3_1_config_choices, 4);
    menu_set_submenu_reg_config_values(Mixer4_1, mixer4_1_config_choices, 4);
    menu_set_submenu_reg_config_addresses(Mixer3_1, R23_PB_MIXER_L_CTRL_1, 4);
    menu_set_submenu_reg_config_addresses(Mixer4_1, R25_PB_MIXER_R_CTRL_1, 4);




    // create Mixer 1, Mixer 2, Mixer 3, Mixer 4 submenus
    char *mixer1_2_3_4_options[4]={"mute","0dB","3dB","6dB"};
    menu_create_submenus(Mixer1, 4, mixer1_2_3_4_options);
    menu_create_submenus(Mixer2, 4, mixer1_2_3_4_options);
    menu_create_submenus(Mixer3, 4, mixer1_2_3_4_options);
    menu_create_submenus(Mixer4, 4, mixer1_2_3_4_options);


    // create Mixer 5 and Mixer 6 submenus
    char*mixer5_6_options[5]={"mute", "MXG3 (left input) 0dB", "MXG3 (left input) 6dB",
                              "MXG4 (right input) 0dB", "MXG4 (right input) 6dB"};
    menu_create_submenus(Mixer5,5,mixer5_6_options);
    menu_create_submenus(Mixer6,5,mixer5_6_options);

    /* set mixer 1 values and address
    mute MX1AUXG 0x400B r5 = 000;
    0 db MX1AUXG 0x400B r5 = 101;
    3 db MX1AUXG 0x400B r5 = 110;
    6 db MX1AUXG 0x400B r5 = 111;
     */
    uint8_t Mixer1_2_config_choices[4] = {0,0x5,0x6,0x7};
    menu_set_submenu_reg_config_values(Mixer1, Mixer1_2_config_choices, 4);
    menu_set_submenu_reg_config_addresses(Mixer1, R5_REC_MIXER_L_CTRL_1, 4);

    /* set mixer 2 values
    mute MX2AUXG 0x400D r7 = 000;
    0 db MX2AUXG 0x400D r7 = 101;
    3 db MX2AUXG 0x400D r7 = 110;
    6 db MX2AUXG 0x400D r7 = 111;
    */
    menu_set_submenu_reg_config_values(Mixer2, Mixer1_2_config_choices, 4);
    menu_set_submenu_reg_config_addresses(Mixer2, R7_REC_MIXER_R_CTRL_1, 4);

    /* set mixer 3 values
    mute MX3AUXG 0x401C r22 = 00001;
    0 db MX3AUXG 0x401C r22 = 01101;
    3 db MX3AUXG 0x401C r22 = 01111;
    6 db MX3AUXG 0x401C r22 = 10001;
    */
    uint8_t Mixer3_4_config_choices[4] = {1,0xD,0xF,0x11};
    menu_set_submenu_reg_config_values(Mixer3, mixer3_options, 4);
    menu_set_submenu_reg_config_addresses(Mixer3, R22_PB_MIXER_L_CTRL_0, 4);

    /* set mixer 4 values
    mute MX4AUXG 0x401E r24 = 00001;
    0 db MX4AUXG 0x401E r24 = 01101;
    3 db MX4AUXG 0x401E r24 = 01111;
    6 db MX4AUXG 0x401E r24 = 10001;
    */
    menu_set_submenu_reg_config_values(Mixer4, Mixer3_4_config_choices, 4);
    menu_set_submenu_reg_config_addresses(Mixer4, R24_PB_MIXER_R_CTRL_0, 4);

    /* set mixer 5 values
    mute      0x4020 r26 = 1;
    0 db MXG3 0x4020 r26 = 011;
    6 db MXG3 0x4020 r26 = 101;
    0 db MXG4 0x4020 r26 = 10001;
    6 db MXG4 0x4020 r26 = 10001; */
    uint8_t Mixer5_6_config_choices[5] = {1,0x3,0x5,0x9,0x11};
    menu_set_submenu_reg_config_values(Mixer5, Mixer5_6_config_choices, 5);
    menu_set_submenu_reg_config_addresses(Mixer5, R26_PB_LR_MIXER_L_LINE_OUT_CTRL, 5);

    /* set mixer 6 values
    mute      0x4021 r27 = 1;
    0 db MXG3 0x4021 r27 = 011;
    6 db MXG3 0x4021 r27 = 101;
    0 db MXG4 0x4021 r27 = 10001;
    6 db MXG4 0x4021 r27 = 10001;
    */
    menu_set_submenu_reg_config_values(Mixer6, Mixer5_6_config_choices, 5);
    menu_set_submenu_reg_config_addresses(Mixer6, R27_PB_LR_MIXER_R_LINE_OUT_CTRL, 5);

    menu_navigation();
}
